<?php
//----------------------------------------------------------------------------------------------------------------//
//----------------------------------------Recup info sur l'utilisateur--------------------------------------------//

$utilisateur_id = ID_DE_LUTILISATEUR;
$user = utilisateur::where('utilisateur_id', '=', $utilisateur_id)->first();

//----------------------------------------------------------------------------------------------------------------//
//------------------------------Liste des utilisateur qui ne sont pas ami de l'utilisateur------------------------//

$utilisateur_id = ID_DE_LUTILISATEUR;
$tabIDFavori = array($utilisateur_id );
$user = utilisateur::where('utilisateur_id', '=', $utilisateur_id )->first();
foreach ($user->contact as $contact) {
    $userContactID = $contact->contact_id;
    array_push($tabIDFavori, $userContactID);
}
$pascontact = utilisateur::whereNotIn('utilisateur_id', $tabIDFavori)->get();
foreach ($pascontact as $utilisateurNonContact) {
    // ICI tu as les utilisateurs qui ne sont pas en contact de ton utilisateur
}
//----------------------------------------------------------------------------------------------------------------//
//--------------------Requete de recupération des evenement d'un utilisateur pour la page d'accueil---------------//

$utilisateur_id = ID_DE_LUTILISATEUR;
$user = utilisateur::where('utilisateur_id', '=', $utilisateur_id)->first();
foreach ($user->evenement as $event) {
    //Chaque evenements de l'utilisateur (variable $user->evenement) dans la variable $event 
}

//------------------------------------TRIE PAR DATE CROISSANTE----------------------------------------------------// 

$utilisateur_id = ID_DE_LUTILISATEUR;
$user = utilisateur::where('utilisateur_id', '=', $utilisateur_id)->first();
foreach ($user->evenement()->orderBy('dateDebut')->get() as $event) {
    //Chaque evenements de l'utilisateur (variable $user->evenement) dans la variable $event     
}

//----------------------------------------------------------------------------------------------------------------//
//----------------------------------------Recuperer les contact d'un utilisateur----------------------------------// 

$utilisateur_id = ID_DE_LUTILISATEUR;
$user = utilisateur::where('utilisateur_id', '=', $utilisateur_id )->first();
foreach ($user->contact as $contact) {
    $userContact= utilisateur::where('utilisateur_id', '=', $contact->contact_id)->first();
    //Chaque $userContact represente l'objet representant l'utilisateur etant un Favori de l'utilisateur ayant 
    //  pour ID celui de $utilisateur_id
}

//----------------------------------------------------------------------------------------------------------------//
//------------------------------------------------Supprimmer un contact-------------------------------------------//

$utilisateur_id = ID_DE_LUTILISATEUR;
$contact_id = ID_DU_CONTACT;
$contact = contact::where('utilisateur_id', '=', $utilisateur_id )->where('contact_id', '=', $contact_id )->first();
$contact->delete();

//----------------------------------------------------------------------------------------------------------------//
//-------------------------------------------------Ajouter un contact---------------------------------------------//

$utilisateur_id = ID_DE_LUTILISATEUR;
$contact_id = ID_DU_CONTACT;
$contact = new contact();
$contact->utilisateur_id = $utilisateur_id;
$contact->contact_id = $contact_id;
$contact->save();
//----------------------------------------------------------------------------------------------------------------//
//-------------------------------------------------Creer un evenement---------------------------------------------//
$evenement = new evenement();
$evenement->public = ; // 0 pour privé 
					   // 1 pour public 
$evenement->notification = ; // 0 pour privé 
							 // 1 pour public 
$evenement->intitule = ; // Titre de l'evenement (max 255char)
$evenement->dateDebut = ; // FORMAT : 'YYYY-MM-DD' , Exemple '2018-5-17'
$evenement->dateFin = ; // FORMAT : 'YYYY-MM-DD' , Exemple '2018-5-17'
$evenement->description = ; // Description de l'evenement (max 255char)
$evenement->lieu = ; // Lieu de l'evenement (max 255char)
$evenement->suppressionAutomatique = ; // 1 pour activer ou 0 (default = 0)

$evenement->save(); 
// PS : oubliez pas d'ajouter l'utilisateur en proprietaire (CF ci-dessous)

//----------------------------------------------------------------------------------------------------------------//
//------------------------------------Ajouter un utilisateur a un evenement---------------------------------------//

$evenement_id = ID_DE_LEVENEMENT;
$utilisateur_id = ID_DE_LUTILISATEUR;
$evenement = evenement::where('evenement_id','=',$evenement_id)->first();
$droit = ; // Au choix : 'proprietaire','editeur','visiteur' 
$evenement->utilisateur()->attach($utilisateur_id,['droit'=>$droit]);

//----------------------------------------------------------------------------------------------------------------//
//--------------------------Modifier les droits d'un utilisateur a un evenement-----------------------------------//
$evenement_id = ID_DE_LEVENEMENT;
$utilisateur_id = ID_DE_LUTILISATEUR;
$evenement = evenement::where('evenement_id','=',$evenement_id)->first();
$nouveauDroit = ; // Au choix : 'proprietaire','editeur','visiteur' 
$evenement->utilisateur()->updateExistingPivot($utilisateur_id, ['droit' => $nouveauDroit], false);
//----------------------------------------------------------------------------------------------------------------//
//----------------------------------------------------------------------------------------------------------------//
//----------------------------------------------------------------------------------------------------------------//
//----------------------------------------------------------------------------------------------------------------//
//----------------------------------------------------------------------------------------------------------------//
//----------------------------------------------------------------------------------------------------------------//
//----------------------------------------------------------------------------------------------------------------//
//----------------------------------------------------------------------------------------------------------------//